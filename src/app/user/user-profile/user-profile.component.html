<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport"
        content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <title>Document</title>
</head>
<body>

<div *ngIf="session.GetSessionRole() == 'User' && user ">
  <div class="forma" style="max-width: 70%; margin-left: auto;margin-right: auto;padding-bottom: 20px">

      <div class="card-body">
        <h1 class="fa  fa-user fa-5x"></h1>
        <div class="info">
          <p class="text" style="margin-left: 9%">{{user.firstName}}</p>
          <p class="text" style="margin-left: 9%">{{user.lastName}}</p>
          <p class="text" style="margin-left: 9%">{{user.email}}</p>
          <p class="text" style="margin-left: 9%">{{user.state}}</p>
          <p class="text" style="margin-left: 9%">{{user.city}}</p>
          <p class="text" style="margin-left: 9%">{{user.address}}</p>
          <p class="text" style="margin-left: 9%">{{user.zipCode}}</p>
        </div>
        <button (click)="addUserDialog.showModal()">Change profile information</button>
        <dialog #addUserDialog>
          <i class="fa fa-solid fa-close" style="font-size:30px;color:red;float: right" (click)="addUserDialog.close()"></i>
          <!--<div class="header">Upravenie profilu</div>-->
          <div class="">
            <form [formGroup]="formUpdate" (submit)="saveUpdate()">
              <div class="container" >
                <h1 style="padding-bottom: 0.5rem; padding-top: 1rem">Change profile information</h1>
                <hr>
                <label><b>E-mail</b></label>
                <input type="text" formControlName="email" placeholder="Enter E-mail">
                <p></p>
                <label><b>First Name</b></label>
                <input type="text" formControlName="firstName" placeholder="Enter First Name">
                <p></p>
                <label ><b>Last Name</b></label>
                <input type="text" formControlName="lastName" placeholder="Enter Last Name">
                <p></p>
                <label><b>Phone</b></label>
                <input type="text" formControlName="phone" placeholder="Enter Phone">
                <p></p>
                <label><b>Address</b></label>
                <input type="text" formControlName="address" placeholder="Enter Address">
                <p></p>
                <label><b>City</b></label>
                <input type="text" formControlName="city" placeholder="Enter City">
                <p></p>
                <label><b>State</b></label>
                <input type="text" formControlName="state" placeholder="Enter State">
                <p></p>
                <label><b>Zipcode</b></label>
                <input type="text" formControlName="zipCode" placeholder="Enter Zip Code">
                <hr>

                <button class="button1" type="submit" [disabled]="formUpdate.invalid" (click)="addUserDialog.close()">
                  Save changes
                </button>
              </div>
            </form>
          </div>

        </dialog>
      </div>
    </div>
      <div class="forma" style="max-width: 70%; margin-left: auto;margin-right: auto;padding-bottom: 20px"  *ngFor="let order of orders">
        <h1>Order Number: <b>{{order.orderId}}</b></h1>
        <p>Order Date: <b>{{order.date}}</b></p>
        <div *ngFor="let product of order.orderedProducts">

          <a href="/detail/{{product.productId.id}}" style="text-decoration: none; color: black">
            <div class="card-body">
              <h3 class="card-title" >{{product.productId.name}} </h3>
              <div class="info">
                <p class="text" style="margin-left: 9%"> <b>Price</b> {{product.productId.price}}</p>
                <p class="card-text" style="margin-left: 9%"><b>Size</b> {{product.size}}</p>
                <p style="margin-left: 9%"><b>Type:</b> {{product.productId.type}}</p>

              </div>
            </div>
          </a>

          <hr>
        </div>
      </div>
</div>

    <div  *ngIf="session.GetSessionRole() == 'Admin'">
      <p>Find user by email</p>
      <div class="search">
        <app-search
          (searchedTextChanged)="onSearchTextEntered($event)"
        ></app-search>
      </div>
      <h1>Admin Page</h1>
      <div  *ngFor="let order of allOrders">

        <div class="forma" style="max-width: 70%; margin-left: auto;margin-right: auto;padding-bottom: 20px"  *ngIf="searchText === '' || order.customer_ID.email.toLowerCase().includes(searchText.toLowerCase())">
          <h1>Order Number: <b>{{order.orderId}}</b></h1>
          <p>Order Date: <b>{{order.date}}</b></p>
          <p>User Name: <a class="hyperlink" style="text-decoration: underline;color: rebeccapurple;cursor: pointer" (click)="addUserDialog.showModal();getUserByIdFromSite(order.customer_ID.id)">{{order.customer_ID.firstName}} {{order.customer_ID.lastName}}</a></p>
          <dialog #addUserDialog>
            <i class="fa fa-solid fa-close" style="font-size:30px;color:red;float: right" (click)="addUserDialog.close()"></i>
            <div class="" *ngIf="user">
              <p>{{user.firstName}} {{user.lastName}}</p>
              <p>{{user.email}}</p>
              <p>{{user.phone}}</p>
              <p>{{user.state}}</p>
              <p>{{user.address}}</p>
              <p>{{user.city}}</p>
              <p>{{user.zipCode}}</p>
            </div>

          </dialog>
          <div *ngFor="let product of order.orderedProducts">

            <a href="/detail/{{product.productId.id}}" style="text-decoration: none; color: black">
              <div class="card-body">
                <h3 class="card-title" >{{product.productId.name}} </h3>
                <div class="info">
                  <p class="text" style="margin-left: 9%"> <b>Price</b> {{product.productId.price}}</p>
                  <p class="card-text" style="margin-left: 9%"><b>Size</b> {{product.size}}</p>
                  <p style="margin-left: 9%"><b>Type:</b> {{product.productId.type}}</p>

                </div>
              </div>
            </a>

            <hr>
          </div>
        </div>
        </div>

    </div>

</body>
</html>
